# 多平台视频上传工具执行流程和页面跳转梳理

## 1. 有头模式登录流程
- **模式**: 有头模式 (headful)
- **目的**: 登录账号保存Cookie
- **流程**:
    1. 初始化有头模式浏览器实例
    2. 访问登录页面 
    3. 打开浏览器让用户手动登录
    4. 监听页面是否跳转到创作者中心首页
    5. 登录成功后保存Cookie到账户文件
    6. 用户关闭页面或浏览器时，清理资源并退出登录流程

## 2. 无头模式验证Cookie流程
- **模式**: 无头模式 (headless)
- **目的**: 验证Cookie是否有效
- **流程**:
    1. 初始化无头模式浏览器实例
    2. 访问上传页面
    3. 等待页面跳转到上传页面
    4. 检查页面上是否有登录相关元素（手机号登录、扫码登录、登录按钮等）
    5. 如果有登录元素，说明Cookie失效，返回验证失败
    6. 如果没有登录元素，说明Cookie有效，返回验证成功
    7. 清理资源（关闭页面，保留浏览器和上下文供后续使用）

## 3. 无头模式上传视频流程
- **模式**: 无头模式 (headless)
- **目的**: 执行视频上传
- **流程**:
    1. 检查账户文件是否存在，如果不存在则跳转到登录流程
    2. 验证Cookie是否有效，如果无效则跳转到登录流程
    3. 初始化无头模式浏览器实例 
    4. 导航到起始URL 
    5. 跳转到上传页面
    6. 上传视频文件
    7. 等待上传完成 
    8. 填写视频信息
    9. 设置封面
    10. 设置定时发布（如有）
    11. 点击发布
    12. 保存Cookie
    13. 清理资源（关闭页面，保留浏览器和上下文供后续使用）

## 4. 主流程（整合上述流程）
- **目的**: 统一协调各子流程
- **流程**:
    1. 检查账户文件是否存在
    2. 如果不存在，跳转到有头模式登录流程
    3. 如果存在，执行无头模式验证Cookie流程
    4. 如果Cookie验证失败，跳转到有头模式登录流程
    5. 如果Cookie验证成功，执行无头模式上传视频流程
    6. 上传完成后，返回结果

## 5. 流程间关系
- **主流程** → **有头模式登录流程**：账户文件不存在或Cookie验证失败时
- **主流程** → **无头模式验证Cookie流程**：账户文件存在时
- **主流程** → **无头模式上传视频流程**：Cookie验证成功后
- **有头模式登录流程** → **主流程**：登录完成后，重新执行主流程
- **无头模式验证Cookie流程** → **主流程**：验证完成后，根据结果决定下一步

## 6.开发阶段可以都设置为有头模式
- 方便排查错误
- 进行调试